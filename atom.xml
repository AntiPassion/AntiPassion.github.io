<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>林中小屋</title>
  
  
  <link href="http://antipassion.github.io/atom.xml" rel="self"/>
  
  <link href="http://antipassion.github.io/"/>
  <updated>2022-03-03T04:54:39.015Z</updated>
  <id>http://antipassion.github.io/</id>
  
  <author>
    <name>Nayon</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CVE-2021-42287/CVE-2021-42278分析复现</title>
    <link href="http://antipassion.github.io/2022/03/01/CVE-2021-42287-CVE-2021-42278%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0/"/>
    <id>http://antipassion.github.io/2022/03/01/CVE-2021-42287-CVE-2021-42278%E5%88%86%E6%9E%90%E5%A4%8D%E7%8E%B0/</id>
    <published>2022-03-01T15:04:11.000Z</published>
    <updated>2022-03-03T04:54:39.015Z</updated>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;距离漏洞披露已经过了许久，现在终于有些空余时间用于学习复现这两个漏洞。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;概括&quot;&gt;&lt;a href=&quot;#概括&quot; class=&quot;headerlink&quot; title=&quot;概括&quot;&gt;&lt;/a&gt;概括&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;CVE-2021-42278，机器账户的名称一般用&lt;code&gt;$&lt;/code&gt;结尾，但AD并未对域内机器账户名进行验证。&lt;/li&gt;
&lt;li&gt;CVE-2021-42287， 结合上述42278漏洞，创建一个与DC机器账户名称相同的机器账户(不以$结尾)，使用该账户请求一个TGT后，修改账户名，然后通过S4U2Self申请TGS Ticket，然后DC进行在&lt;code&gt;TGS_REP&lt;/code&gt;阶段加密&lt;code&gt;TGS Ticket&lt;/code&gt;时，无法找到该账户利用机器账户hash加密，DC便使用自己的hash加密&lt;code&gt;TGS Ticket&lt;/code&gt;，提供一个属于该账户的&lt;code&gt;PAC&lt;/code&gt;，我们便可得到一个高权限的ST。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;攻击流程&quot;&gt;&lt;a href=&quot;#攻击流程&quot; class=&quot;headerlink&quot; title=&quot;攻击流程:&quot;&gt;&lt;/a&gt;攻击流程:&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;首先创建一个机器账户&lt;/li&gt;
&lt;li&gt;清除机器账户的&lt;code&gt;servicePrincipalName&lt;/code&gt;属性&lt;/li&gt;
&lt;li&gt;将机器账户的&lt;code&gt;sAMAccountName&lt;/code&gt;修改为DC的机器账户名，但不带$&lt;/li&gt;
&lt;li&gt;使用机器账户的身份请求TGT&lt;/li&gt;
&lt;li&gt;将机器账户的&lt;code&gt;sAMAccountName&lt;/code&gt;修改为其他值，不能与DC的机器账户名重复。&lt;/li&gt;
&lt;li&gt;通过S4U2Self向KDC申请ST&lt;/li&gt;
&lt;li&gt;拿到高权限ST票据，完成利用。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;利用原理：如果域内存在一台域控名为DC(机器账户为DC$)的域控机，此时攻击者可利用CVE-2021-42287漏洞去申请一个机器账户，再将机器账户的&lt;code&gt;sAMAccountName&lt;/code&gt;修改为DC。然后再利用这个机器账户去申请一个TGT票据，再将DC的&lt;code&gt;sAMAccountName&lt;/code&gt;修改为其他。修改结束后再利用这个TGT通过S4U2Self去申请ST票据，此时KDC识别TGT票据内用户名为DC，检索到域内并未存在DC用户，但存在DC$用户(检索的依据为sAMAccountName值)，于是KDC通过DC机器的hash加密票据，我们便可成功拿到DC的权限。&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>利用机器账户进行域提权</title>
    <link href="http://antipassion.github.io/2022/02/19/%E5%88%A9%E7%94%A8%E6%9C%BA%E5%99%A8%E8%B4%A6%E6%88%B7%E8%BF%9B%E8%A1%8C%E5%9F%9F%E6%8F%90%E6%9D%83/"/>
    <id>http://antipassion.github.io/2022/02/19/%E5%88%A9%E7%94%A8%E6%9C%BA%E5%99%A8%E8%B4%A6%E6%88%B7%E8%BF%9B%E8%A1%8C%E5%9F%9F%E6%8F%90%E6%9D%83/</id>
    <published>2022-02-19T14:40:56.000Z</published>
    <updated>2022-03-01T15:05:04.103Z</updated>
    
    
    <summary type="html">&lt;p&gt;pass the hash攻击，除去常见的使用本地管理员账户进行hash传递外，还可以使用机器账户进行提权。&lt;/p&gt;
&lt;p&gt;如果在主机上授予了本地管理员访问权限，并且计算机本身为&lt;code&gt;Domain admins&lt;/code&gt;组的成员，那我们在进行渗透测试时，可以利用该计算机账户进行提权。以机器账户来使用hash传递来进行提权。&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>利用机器账户进行域维权</title>
    <link href="http://antipassion.github.io/2022/02/15/%E5%88%A9%E7%94%A8%E6%9C%BA%E5%99%A8%E8%B4%A6%E6%88%B7%E8%BF%9B%E8%A1%8C%E5%9F%9F%E7%BB%B4%E6%9D%83/"/>
    <id>http://antipassion.github.io/2022/02/15/%E5%88%A9%E7%94%A8%E6%9C%BA%E5%99%A8%E8%B4%A6%E6%88%B7%E8%BF%9B%E8%A1%8C%E5%9F%9F%E7%BB%B4%E6%9D%83/</id>
    <published>2022-02-15T14:54:20.000Z</published>
    <updated>2022-02-19T10:42:57.372Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;机器账户在许多技术中可以用于提权或横向移动，如使用机器账户的委派进行dcsyn了上述作用，使用机器账户也可进行维权操作。我们可以将任意计算机账户添加到高权限组(例如Domain Admin、Domain Controllers、Enterprise Admins) 或对计算机账户的userAccountControl属性进行修改。使用这两种方式，我们可以通过机器账户在域内进行身份认证（因为密码已知）并进行提权操作，例如Dcsync拖取域内hash。&lt;/p&gt;
&lt;p&gt;除了上述作用，使用机器账户也可进行域维权操作。我们可以将任意计算机账户添加到高权限组(例如Domain Admin、Domain Controllers、Enterprise Admins) 或对计算机账户的&lt;code&gt;userAccountControl&lt;/code&gt;属性进行修改。使用这两种方式，我们可以通过机器账户在域内进行身份认证（因为密码已知）并进行提权操作，例如Dcsync拖取域内hash。&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>基于资源的约束委派</title>
    <link href="http://antipassion.github.io/2022/01/30/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/"/>
    <id>http://antipassion.github.io/2022/01/30/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE/</id>
    <published>2022-01-30T04:44:17.000Z</published>
    <updated>2022-03-02T10:32:23.033Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;基于资源的约束委派利用&quot;&gt;&lt;a href=&quot;#基于资源的约束委派利用&quot; class=&quot;headerlink&quot; title=&quot;基于资源的约束委派利用&quot;&gt;&lt;/a&gt;基于资源的约束委派利用&lt;/h3&gt;&lt;p&gt;基于资源的约束委派，(Resource-based constrained delegation)，与前文提到的约束委派不同，它在信任的传递关系上是不同的，这也是它工作方向相反的一个因素。&lt;/p&gt;
&lt;p&gt;在约束委派中，账户A到账户B的约束委派在账户A的 msDS-AllowedToDelegateTo 属性中配置，并且定义了A到B的传出&lt;code&gt;信任&lt;/code&gt;,而在基于资源的约束委派当中，委派在账户B的msDS-AllowedToActOnBehalfOfOtherIdentity 属性中配置，并定义了A到B的&lt;code&gt;传入&lt;/code&gt;信任。&lt;/p&gt;
&lt;p&gt;一图概括。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/../images/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE.assets/image-20220204202427514.png&quot; alt=&quot;image-20220204202427514&quot;&gt;&lt;/p&gt;
&lt;p&gt;如图为在Elad师傅中的文章中所得的导图，通过此图，我们可以看出基于资源的约束委派与传统约束委派的工作方式有何不同。&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>约束委派攻击</title>
    <link href="http://antipassion.github.io/2022/01/09/%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/"/>
    <id>http://antipassion.github.io/2022/01/09/%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/</id>
    <published>2022-01-09T15:21:05.000Z</published>
    <updated>2022-02-25T14:33:15.941Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;约束委派&quot;&gt;&lt;a href=&quot;#约束委派&quot; class=&quot;headerlink&quot; title=&quot;约束委派&quot;&gt;&lt;/a&gt;约束委派&lt;/h2&gt;&lt;p&gt;接上述的非约束委派，由于非约束委派的不安全性，微软在windows2003中发布了约束委派的功能。约束委派在Kerberos中User不会直接发送TGT给服务，而是对发送给service1的认证信息做了限制，不允许service1代表User使用这个TGT去访问其他服务。这里包括一组名为S4U2Self（Service for User to  Self）和S4U2Proxy（Service for User to Proxy）的Kerberos协议扩展。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;流程:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB.assets/image-20220109233827841.png&quot; alt=&quot;    &quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>非约束委派攻击</title>
    <link href="http://antipassion.github.io/2022/01/06/%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/"/>
    <id>http://antipassion.github.io/2022/01/06/%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/</id>
    <published>2022-01-06T15:18:28.000Z</published>
    <updated>2022-02-06T06:14:03.665Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;委派&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;在域中如果出现A使用Kerberos身份验证访问域中的服务B,而B再利用A的身份去请求域中的服务C，这个过程就可以理解为委派&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/%E9%9D%9E%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB.assets/image-20220106232045335.png&quot; alt=&quot;image-20220106232045335&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;例&quot;&gt;&lt;a href=&quot;#例&quot; class=&quot;headerlink&quot; title=&quot;例:&quot;&gt;&lt;/a&gt;例:&lt;/h4&gt;&lt;figure class=&quot;highlight c++&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;User访问主机S2上的HTTP服务，此时要想完整的使用HTTP服务，需再访问S3主机上的SQL数据库，但S2并不知道域用户是否拥有权限访问S3上的数据库服务权限，这时为了验证权限，S2会带着User的访问权限去申请访问SQL数据库，若User拥有权限才可进行访问。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&quot;非约束委派&quot;&gt;&lt;a href=&quot;#非约束委派&quot; class=&quot;headerlink&quot; title=&quot;非约束委派&quot;&gt;&lt;/a&gt;非约束委派&lt;/h3&gt;&lt;p&gt;非约束委派Kerberos中实现时，User会将自KDC拿到的TGT发送给访问的服务机器Service1,Service1再通过拿到手的TGT票据去申请访问其他域内服务，Service1在拿到用户的TGT票据后，会对其留存，以便下次备用，这时，我们便可在拿下的Service1机器中拿到域用户的TGT票据，从而访问域内的可访问服务(域管用户可访问任意服务)&lt;/p&gt;</summary>
    
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="域渗透" scheme="http://antipassion.github.io/tags/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>PE结构-DOS头</title>
    <link href="http://antipassion.github.io/2021/11/19/PE%E7%BB%93%E6%9E%84-DOS%E5%A4%B4/"/>
    <id>http://antipassion.github.io/2021/11/19/PE%E7%BB%93%E6%9E%84-DOS%E5%A4%B4/</id>
    <published>2021-11-19T11:40:13.000Z</published>
    <updated>2022-01-28T04:40:12.523Z</updated>
    
    
    <summary type="html">&lt;p&gt;PE结构-DOS头，本部分为参照吾爱破解论坛lyl610abc师傅&lt;a href=&quot;https://www.52pojie.cn/thread-1403011-1-1.html&quot;&gt;PE文件笔记&lt;/a&gt;所整理的学习笔记。&lt;/p&gt;
&lt;h3 id=&quot;DOS部首&quot;&gt;&lt;a href=&quot;#DOS部首&quot; class=&quot;headerlink&quot; title=&quot;DOS部首&quot;&gt;&lt;/a&gt;DOS部首&lt;/h3&gt;&lt;h4 id=&quot;DOS部首结构&quot;&gt;&lt;a href=&quot;#DOS部首结构&quot; class=&quot;headerlink&quot; title=&quot;DOS部首结构&quot;&gt;&lt;/a&gt;DOS部首结构&lt;/h4&gt;</summary>
    
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/categories/PE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/tags/PE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>PE结构-PE文件的两种状态</title>
    <link href="http://antipassion.github.io/2021/11/16/PE%E7%BB%93%E6%9E%84-PE%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%8A%B6%E6%80%81/"/>
    <id>http://antipassion.github.io/2021/11/16/PE%E7%BB%93%E6%9E%84-PE%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%8A%B6%E6%80%81/</id>
    <published>2021-11-16T06:50:09.000Z</published>
    <updated>2022-01-28T04:40:15.231Z</updated>
    
    
    <summary type="html">&lt;p&gt;本文的是学习复现自吾爱破解dalao &lt;a href=&quot;https://www.52pojie.cn/thread-1393291-1-1.html&quot;&gt;lyl610abc&lt;/a&gt;的PE文件解析系列，非本人原创，属于学习笔记(大佬yyds!)。&lt;/p&gt;
&lt;h3 id=&quot;PE文件的两种状态&quot;&gt;&lt;a href=&quot;#PE文件的两种状态&quot; class=&quot;headerlink&quot; title=&quot;PE文件的两种状态&quot;&gt;&lt;/a&gt;PE文件的两种状态&lt;/h3&gt;&lt;p&gt;PE文件处于磁盘中与处于内存中时，两者的结构会稍微发生改变。&lt;/p&gt;</summary>
    
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/categories/PE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/tags/PE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>SSTI模板注入学习</title>
    <link href="http://antipassion.github.io/2021/11/12/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/"/>
    <id>http://antipassion.github.io/2021/11/12/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/</id>
    <published>2021-11-12T11:02:54.000Z</published>
    <updated>2022-01-28T04:40:44.527Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;SSTI模板注入&quot;&gt;&lt;a href=&quot;#SSTI模板注入&quot; class=&quot;headerlink&quot; title=&quot;SSTI模板注入&quot;&gt;&lt;/a&gt;SSTI模板注入&lt;/h2&gt;&lt;p&gt;根据yu22x师傅文章&lt;a href=&quot;https://blog.csdn.net/miuzzx/article/details/110220425?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163671502616780271551002%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=163671502616780271551002&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_v29-2-110220425.pc_v2_rank_blog_default&amp;utm_term=ssti&amp;spm=1018.2226.3001.4450&quot;&gt;SSTI模板注入绕过（进阶篇）&lt;/a&gt;复现学习。&lt;/p&gt;
&lt;h3 id=&quot;何为SSTI&quot;&gt;&lt;a href=&quot;#何为SSTI&quot; class=&quot;headerlink&quot; title=&quot;何为SSTI?&quot;&gt;&lt;/a&gt;何为SSTI?&lt;/h3&gt;&lt;p&gt;SSTI,服务器端模板注入&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当服务端接受到攻击者的输入时，将其作为Web应用模板内容的一部分&lt;/li&gt;
&lt;li&gt;在进行目标编译渲染的过程中，进行了语句的拼接，执行了所插入的恶意内容从而导致信息泄露、代码执行、GetShell等问题&lt;/li&gt;
&lt;li&gt;其影响范围主要取决于模版引擎的复杂性&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;模板注入问题主要出现的框架:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Python :jinja2、mako、tornado、django&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;php: smarty、twig&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;java： jade、velocity&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>利用php伪协议绕过die()</title>
    <link href="http://antipassion.github.io/2021/10/31/%E5%88%A9%E7%94%A8php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BB%95%E8%BF%87die/"/>
    <id>http://antipassion.github.io/2021/10/31/%E5%88%A9%E7%94%A8php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BB%95%E8%BF%87die/</id>
    <published>2021-10-31T02:36:35.000Z</published>
    <updated>2022-01-28T04:39:38.171Z</updated>
    
    
    <summary type="html">&lt;p&gt;file_put_content写入文件遇到exit() 、die() 情况分类&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;file_put_contents(&lt;span class=&quot;variable&quot;&gt;$filename&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;lt;?php exit();&amp;quot;&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$contnet&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;file_put_contents(&lt;span class=&quot;variable&quot;&gt;$content&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&amp;quot;&amp;lt;?php die()&amp;quot;&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$contnet&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;file_put_contents(&lt;span class=&quot;variable&quot;&gt;$filename&lt;/span&gt;,&lt;span class=&quot;variable&quot;&gt;$contnet&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&amp;#x27;\nxxxxxx&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;此处我们可以利用php://filter协议，将文件内容中的die或exit解码掉，以便执行后方的其他语句。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;文件名、内容皆可控&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;base64编码绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;利用base64编码解码，将exit die解码为乱码，将恶意代码解码还原。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/%E5%88%A9%E7%94%A8php%E4%BC%AA%E5%8D%8F%E8%AE%AE%E7%BB%95%E8%BF%87die.assets/image-20211031110309150.png&quot; alt=&quot;image-20211031110309150&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>利用session.upload_progress进行文件包含</title>
    <link href="http://antipassion.github.io/2021/10/30/%E5%88%A9%E7%94%A8session-upload-progress%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://antipassion.github.io/2021/10/30/%E5%88%A9%E7%94%A8session-upload-progress%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
    <published>2021-10-30T13:08:14.000Z</published>
    <updated>2022-01-28T04:39:42.404Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;Session-上传进度&quot;&gt;&lt;a href=&quot;#Session-上传进度&quot; class=&quot;headerlink&quot; title=&quot;Session 上传进度&quot;&gt;&lt;/a&gt;Session 上传进度&lt;/h3&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;此特性自PHP &lt;span class=&quot;number&quot;&gt;5.4&lt;/span&gt;.&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;后启用&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/images/%E5%88%A9%E7%94%A8session-upload-progress%E8%BF%9B%E8%A1%8C%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB.assets/image-20211030211326157.png&quot; alt=&quot;image-20211030211326157&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们可以利用&lt;code&gt;session.upload_progress&lt;/code&gt; 将木马写入session文件，然后包含这个文件。但是首先我们需要知道session文件将会保存在何处&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;在Linux php中 session文件默认保存在/tmp/sess_session名中&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;以及会如何保存&lt;/p&gt;</summary>
    
    
    
    <category term="ctf" scheme="http://antipassion.github.io/categories/ctf/"/>
    
    
    <category term="ctf" scheme="http://antipassion.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>php代码审计学习-5</title>
    <link href="http://antipassion.github.io/2021/10/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-5/"/>
    <id>http://antipassion.github.io/2021/10/29/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-5/</id>
    <published>2021-10-29T02:32:50.000Z</published>
    <updated>2022-01-28T04:40:41.267Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;PHP-session反序列化&quot;&gt;&lt;a href=&quot;#PHP-session反序列化&quot; class=&quot;headerlink&quot; title=&quot;PHP session反序列化&quot;&gt;&lt;/a&gt;PHP session反序列化&lt;/h3&gt;&lt;p&gt;本文转自先知社区的panda师傅所写文章&lt;a href=&quot;https://xz.aliyun.com/t/6640#toc-1&quot;&gt;带你走进PHP session反序列化漏洞&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;PHP-Session的工作流程&quot;&gt;&lt;a href=&quot;#PHP-Session的工作流程&quot; class=&quot;headerlink&quot; title=&quot;PHP Session的工作流程&quot;&gt;&lt;/a&gt;PHP Session的工作流程&lt;/h4&gt;&lt;p&gt;当开始一个会话时，php会尝试在请求中查找&lt;code&gt;SessionID&lt;/code&gt; （通常通过会话cookie），如果发现请求的Cookies，Get、Post中并不存在&lt;code&gt;session id&lt;/code&gt;时，php便会自动调用&lt;code&gt;php_session_create_id&lt;/code&gt;函数创建一个新的会话，并且通过http response的set-cookie头发送给客户端进行保存。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-5.assets/image-20211029103800930.png&quot; alt=&quot;image-20211029103800930&quot;&gt;&lt;/p&gt;
&lt;p&gt;当会话开始后，PHP便会将会话中的数据设置到&lt;code&gt;$_SESSION&lt;/code&gt;变量中，下为在一个&lt;code&gt;$_SESSION&lt;/code&gt;变量中注册变量的例子&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;session_start();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!&lt;span class=&quot;keyword&quot;&gt;isset&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable&quot;&gt;$_SESSION&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]=&lt;span class=&quot;string&quot;&gt;&amp;#x27;Nayon&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>php代码审计学习-4</title>
    <link href="http://antipassion.github.io/2021/10/26/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-4/"/>
    <id>http://antipassion.github.io/2021/10/26/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-4/</id>
    <published>2021-10-26T06:45:24.000Z</published>
    <updated>2022-01-28T04:40:37.067Z</updated>
    
    
    <summary type="html">&lt;p&gt;​    &lt;/p&gt;
&lt;h3 id=&quot;espcms-审计&quot;&gt;&lt;a href=&quot;#espcms-审计&quot; class=&quot;headerlink&quot; title=&quot;espcms 审计&quot;&gt;&lt;/a&gt;espcms 审计&lt;/h3&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;资源下载:http:&lt;span class=&quot;comment&quot;&gt;//down.chinaz.com/soft/27695.htm&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;解压安装后，利用esay审计系统进行自动化审计，筛选可疑语句。&lt;/p&gt;
&lt;p&gt;看到一处普通的sql查询语句，右键跟进打开文件&lt;/p&gt;
&lt;p&gt;可以看到，SQL查询在一个类的自定义函数&lt;code&gt;oncitylist&lt;/code&gt;之内&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/*&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  PHP version 5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  Copyright (c) 2002-2010 ECISP.CN&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  声明：这不是一个免费的软件，请在许可范围内使用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  作者：Bili E-mail:huangqyun@163.com  QQ:6326420&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;  http://www.ecisp.cn	http://www.easysitepm.com&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;important&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;connector&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;important&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;softbase(&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;oncitylist&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$parentid&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;fun-&amp;gt;accept(&lt;span class=&quot;string&quot;&gt;&amp;#x27;parentid&amp;#x27;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;#x27;R&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$parentid&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;empty&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$parentid&lt;/span&gt;) ? &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;variable&quot;&gt;$parentid&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$verid&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;fun-&amp;gt;accept(&lt;span class=&quot;string&quot;&gt;&amp;#x27;verid&amp;#x27;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&amp;#x27;R&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$verid&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;empty&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$verid&lt;/span&gt;) ? &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;variable&quot;&gt;$verid&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$db_table&lt;/span&gt; = db_prefix . &lt;span class=&quot;string&quot;&gt;&amp;#x27;city&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$sql&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&amp;quot;select * from &lt;span class=&quot;subst&quot;&gt;$db_table&lt;/span&gt; where parentid=&lt;span class=&quot;subst&quot;&gt;$parentid&lt;/span&gt;&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;variable&quot;&gt;$rs&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;db-&amp;gt;query(&lt;span class=&quot;variable&quot;&gt;$sql&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt; = &lt;span class=&quot;keyword&quot;&gt;$this&lt;/span&gt;-&amp;gt;db-&amp;gt;fetch_array(&lt;span class=&quot;variable&quot;&gt;$rs&lt;/span&gt;); &lt;span class=&quot;variable&quot;&gt;$i&lt;/span&gt;++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;variable&quot;&gt;$verid&lt;/span&gt; == &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;]) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;variable&quot;&gt;$list&lt;/span&gt;.=&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;lt;option selected value=&amp;quot;&amp;#x27;&lt;/span&gt; . &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;] . &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;quot;&amp;gt;&amp;#x27;&lt;/span&gt; . &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;cityname&amp;#x27;&lt;/span&gt;] . &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;lt;/option&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				&lt;span class=&quot;variable&quot;&gt;$list&lt;/span&gt;.=&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;lt;option value=&amp;quot;&amp;#x27;&lt;/span&gt; . &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;id&amp;#x27;&lt;/span&gt;] . &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;quot;&amp;gt;&amp;#x27;&lt;/span&gt; . &lt;span class=&quot;variable&quot;&gt;$rsList&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;cityname&amp;#x27;&lt;/span&gt;] . &lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;lt;/option&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;exit&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$list&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>PHP代码审计学习-3</title>
    <link href="http://antipassion.github.io/2021/10/25/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-3/"/>
    <id>http://antipassion.github.io/2021/10/25/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-3/</id>
    <published>2021-10-25T04:37:09.000Z</published>
    <updated>2022-01-28T04:40:31.479Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;动态函数执行和匿名函数执行&quot;&gt;&lt;a href=&quot;#动态函数执行和匿名函数执行&quot; class=&quot;headerlink&quot; title=&quot;动态函数执行和匿名函数执行&quot;&gt;&lt;/a&gt;动态函数执行和匿名函数执行&lt;/h3&gt;&lt;h4 id=&quot;动态函数执行&quot;&gt;&lt;a href=&quot;#动态函数执行&quot; class=&quot;headerlink&quot; title=&quot;动态函数执行&quot;&gt;&lt;/a&gt;动态函数执行&lt;/h4&gt;&lt;p&gt;函数与函数之间的调用，可能会产生漏洞。&lt;/p&gt;
&lt;p&gt;测试demo&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;b&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;c&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$args1&lt;/span&gt;,&lt;span class=&quot;variable&quot;&gt;$args2&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable&quot;&gt;$args1&lt;/span&gt;(&lt;span class=&quot;variable&quot;&gt;$args2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$action&lt;/span&gt;=&lt;span class=&quot;variable&quot;&gt;$_GET&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;action&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$cmd&lt;/span&gt;=&lt;span class=&quot;variable&quot;&gt;$_GET&lt;/span&gt;[&lt;span class=&quot;string&quot;&gt;&amp;#x27;cmd&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c(&lt;span class=&quot;variable&quot;&gt;$action&lt;/span&gt;,&lt;span class=&quot;variable&quot;&gt;$cmd&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//浏览器获取到的值 b ，现在作为 c() 函数的参数插入到了函数中，并且在函数中作为函数名调用了另外一个函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/images/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-3.assets/image-20211025160512247.png&quot; alt=&quot;image-20211025160512247&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>php代码审计学习(2)</title>
    <link href="http://antipassion.github.io/2021/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-2/"/>
    <id>http://antipassion.github.io/2021/10/24/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-2/</id>
    <published>2021-10-24T11:25:29.000Z</published>
    <updated>2022-01-28T04:40:25.417Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;PHP伪协议学习&quot;&gt;&lt;a href=&quot;#PHP伪协议学习&quot; class=&quot;headerlink&quot; title=&quot;PHP伪协议学习&quot;&gt;&lt;/a&gt;PHP伪协议学习&lt;/h3&gt;&lt;p&gt;参考自 &lt;a href=&quot;https://segmentfault.com/a/1190000018991087&quot;&gt;PHP伪协议总结&lt;/a&gt;、 &lt;a href=&quot;https://segmentfault.com/a/1190000018991087&quot;&gt;php伪协议实现命令执行的七种姿势&lt;/a&gt;两篇文章进行复现学习。&lt;/p&gt;
&lt;h4 id=&quot;file-协议&quot;&gt;&lt;a href=&quot;#file-协议&quot; class=&quot;headerlink&quot; title=&quot;file:// 协议&quot;&gt;&lt;/a&gt;file:// 协议&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;条件&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;allow_url_fopen:off/on &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;allow_url_include:off/on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#翻译一下就是file://协议的使用，不受这两个属性的开关的影响&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;作用&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>PHP代码审计学习-1</title>
    <link href="http://antipassion.github.io/2021/10/24/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-1/"/>
    <id>http://antipassion.github.io/2021/10/24/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AD%A6%E4%B9%A0-1/</id>
    <published>2021-10-24T02:26:22.000Z</published>
    <updated>2022-01-28T04:40:20.955Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;审计时可能会涉及到的超全局变量&quot;&gt;&lt;a href=&quot;#审计时可能会涉及到的超全局变量&quot; class=&quot;headerlink&quot; title=&quot;审计时可能会涉及到的超全局变量&quot;&gt;&lt;/a&gt;审计时可能会涉及到的超全局变量&lt;/h4&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$GLOBALS&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_SERVER&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_REQUEST&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_POST&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_GET&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_FILES&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_ENV&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_COOKIE&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$_SESSION&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
    <category term="代码审计" scheme="http://antipassion.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>awd知识梳理</title>
    <link href="http://antipassion.github.io/2021/10/22/awd%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/"/>
    <id>http://antipassion.github.io/2021/10/22/awd%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/</id>
    <published>2021-10-22T09:02:01.000Z</published>
    <updated>2022-01-28T04:39:55.140Z</updated>
    
    
    <summary type="html">&lt;p&gt;由于一个月后需要参加一项awd比赛，为了防止过去之后什么也不懂的情况发生，写下这篇笔记用于记录整理awd比赛可能会用到的一些零零碎碎的知识点。&lt;/p&gt;
&lt;h2 id=&quot;0X01-目录索引&quot;&gt;&lt;a href=&quot;#0X01-目录索引&quot; class=&quot;headerlink&quot; title=&quot;0X01 目录索引&quot;&gt;&lt;/a&gt;0X01 目录索引&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;加固阶段&lt;/li&gt;
&lt;li&gt;攻防阶段&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    
    <category term="ctf" scheme="http://antipassion.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DLL劫持学习</title>
    <link href="http://antipassion.github.io/2021/10/18/dll%E5%8A%AB%E6%8C%81%E5%AD%A6%E4%B9%A0/"/>
    <id>http://antipassion.github.io/2021/10/18/dll%E5%8A%AB%E6%8C%81%E5%AD%A6%E4%B9%A0/</id>
    <published>2021-10-18T00:28:13.000Z</published>
    <updated>2022-01-28T04:39:50.885Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;DLL劫持&quot;&gt;&lt;a href=&quot;#DLL劫持&quot; class=&quot;headerlink&quot; title=&quot;DLL劫持&quot;&gt;&lt;/a&gt;DLL劫持&lt;/h2&gt;&lt;h3 id=&quot;什么是dll文件？&quot;&gt;&lt;a href=&quot;#什么是dll文件？&quot; class=&quot;headerlink&quot; title=&quot;什么是dll文件？&quot;&gt;&lt;/a&gt;什么是dll文件？&lt;/h3&gt;&lt;p&gt;DLL（Dynamic Link Library）被称为动态链接库文件，又被称之为“应用程序拓展”，是软件文件类型。在Windows中，许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库，即DLL文件，放置于系统中。当我们执行某一个程序时，相应的DLL文件就会被调用。一个应用程序可使用多个DLL文件，一个DLL文件也可能被不同的应用程序使用，这样的DLL文件被称为共享DLL文件。&lt;/p&gt;
&lt;p&gt;如果在进程尝试加载一个DLL时没有指定DLL的绝对路径，那么Windows会尝试去按照顺序搜索这些特定目录时下查找这个DLL,只要能够将恶意的DLL放在优先于正常DLL所在的目录，就能够欺骗系统优先加载恶意DLL，来实现”劫持”上线&lt;/p&gt;
&lt;h3 id=&quot;dll原理利用&quot;&gt;&lt;a href=&quot;#dll原理利用&quot; class=&quot;headerlink&quot; title=&quot;dll原理利用&quot;&gt;&lt;/a&gt;dll原理利用&lt;/h3&gt;</summary>
    
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/categories/PE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/tags/PE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>PE结构-VA与FOA的转化</title>
    <link href="http://antipassion.github.io/2021/10/14/PE%E7%BB%93%E6%9E%84-VA%E4%B8%8EFOA%E7%9A%84%E8%BD%AC%E5%8C%96/"/>
    <id>http://antipassion.github.io/2021/10/14/PE%E7%BB%93%E6%9E%84-VA%E4%B8%8EFOA%E7%9A%84%E8%BD%AC%E5%8C%96/</id>
    <published>2021-10-14T03:26:38.000Z</published>
    <updated>2022-01-28T04:40:18.132Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;VA转FOA&quot;&gt;&lt;a href=&quot;#VA转FOA&quot; class=&quot;headerlink&quot; title=&quot;VA转FOA&quot;&gt;&lt;/a&gt;VA转FOA&lt;/h3&gt;&lt;p&gt;相应名词概念&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;对应结构体成员&lt;/th&gt;
&lt;th&gt;英文全称&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;VA&lt;/td&gt;
&lt;td&gt;_IMAGE_SECTION_HEADER.VirtualAddress&lt;/td&gt;
&lt;td&gt;Virtual Address&lt;/td&gt;
&lt;td&gt;在内存中的虚拟地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RVA&lt;/td&gt;
&lt;td&gt;_IMAGE_SECTION_HEADER.VirtualAddress&lt;/td&gt;
&lt;td&gt;Relative Virtual Address&lt;/td&gt;
&lt;td&gt;相对虚拟地址&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FOA&lt;/td&gt;
&lt;td&gt;_IMAGE_SECTION_HEADER.PointerToRawData&lt;/td&gt;
&lt;td&gt;File Offset Address&lt;/td&gt;
&lt;td&gt;文件偏移地址&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;</summary>
    
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/categories/PE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/tags/PE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>PE结构-导出表(3)</title>
    <link href="http://antipassion.github.io/2021/10/14/PE%E7%BB%93%E6%9E%84-%E5%AF%BC%E5%87%BA%E8%A1%A8(3)/"/>
    <id>http://antipassion.github.io/2021/10/14/PE%E7%BB%93%E6%9E%84-%E5%AF%BC%E5%87%BA%E8%A1%A8(3)/</id>
    <published>2021-10-14T03:07:55.000Z</published>
    <updated>2022-01-25T09:19:34.672Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;h1 id=&quot;导出表&quot;&gt;&lt;a href=&quot;#导出表&quot; class=&quot;headerlink&quot; title=&quot;导出表&quot;&gt;&lt;/a&gt;&lt;strong&gt;导出表&lt;/strong&gt;&lt;/h1&gt;&lt;h4 id=&quot;导出表的作用&quot;&gt;&lt;a href=&quot;#导出表的作用&quot;</summary>
        
      
    
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/categories/PE%E7%BB%93%E6%9E%84/"/>
    
    
    <category term="PE结构" scheme="http://antipassion.github.io/tags/PE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
</feed>
